#!/bin/bash
#
# A script to clone the Roots.io Trellis repo and update the example.com urls
# to the production ones.
#

if [ -d trellis ]; then
	echo 'Error: Folder "trellis" already exists.'
	exit 1
fi

if [[ $# -eq 0 ]] ; then
	echo 'A domain is required. For example:'
	echo ''
	echo '  gettrellis updated-url.com'
	echo ''
	exit 1
fi

url=$1

git clone --depth=1 git@github.com:roots/trellis.git && rm -rf trellis/.git

cd trellis
 
echo ''
echo "Updating Trellis development url:"
echo ''
echo "  example.com => ${url}"
echo ''
sed -i -E "s/example.(com|dev)/${url}/g" group_vars/development/wordpress_sites.yml
sed -i -E "s/example.(com|dev)/${url}/g" group_vars/development/vault.yml

